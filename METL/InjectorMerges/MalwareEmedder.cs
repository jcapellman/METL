using System;
using System.IO;

using METL.InjectorMerges.Base;

namespace METL.InjectorMerges
{
    public class MalwareEmedder : BaseInjectorMerge
    {
        public override string FIELD_NAME => "MALWARE_EMBED";

        public override string Merge(string argument = null)
        {
            if (string.IsNullOrEmpty(argument))
            {
                throw new ArgumentNullException(nameof(argument));
            }

            if (!File.Exists(argument))
            {
                throw new FileNotFoundException(argument);
            }

            var malwareBytes = File.ReadAllBytes(argument);

            return $"string malSource = \"{Convert.ToBase64String(malwareBytes)}\";";
        }
    }
}